<div class="row">
    <div class="span7 info-header lead">
        <strong id="topofpage">Create the offer</strong>
    </div>
    <div class="span5 preview-header lead">
        <strong>Preview Card</strong>
    </div>
</div>
<form role="form" name="tier_basics" novalidate>
    <div class="row">
        <div class="span7 info-detail">
            <div class="well">
                <div class="row-fluid">
                    <div class="row-fluid span4">
                        <label>Offer Name</label>
                    </div>
                    <div class="row-fluid span8">
                        <input id="title" placeholder=" e.g. Happy lunch hours!" type="text" ng-model="tmpo.offer.basics.title" ng-click="show_tip_4 = true" ng-disabled="offer_disabled" tooltip="Users on Twyst will be able to see this" tooltip-trigger="focus" tooltip-placement="right">

                        <div class="error" ng-show="offer_basics.outlet_name.$dirty && offer_basics.outlet_name.$invalid">
                            <div class="error" ng-show="offer_basics.outlet_name.$error.required">
                                Required field
                            </div>
                            <div class="error" ng-show="offer_basics.outlet_name.$error.minlength">
                                At least 5 characters
                            </div>
                            <div class="error" ng-show="offer_basics.outlet_name.$error.maxlength">
                                No more than 256 characters
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row-fluid">
                    <div class="row-fluid span4">
                        <label>Offer Description</label>
                    </div>
                    <div class="row-fluid span8">
                        <textarea id="description" class="span10" name="description" placeholder=" Get a free appetizer or desert on your second lunch visit in a week!" ng-model="tmpo.offer.basics.description" ng-click="show_tip_5 = true" tooltip="Users on Twyst will be able to see this"
                        tooltip-trigger="focus" tooltip-placement="right"></textarea>
                    </div>
                </div>
                <div class="row-fluid">
                    <div class="row-fluid span4">
                        <label>QR only?</label>
                    </div>
                    <div class="row-fluid span8">
                        <input type="checkbox" ng-model="tmpo.offer.qr_only">
                    </div>
                </div>
            </div>
            <div class="well">
                <div class="row-fluid">
                    <div class="row-fluid span4">
                        <label>Offer Eligibility</label>
                    </div>
                    <div class="row-fluid span8">
                        <p>The reward will be unlocked on</p>
                    </div>
                </div>
                <div class="row-fluid">
                    <div class="row-fluid span4">
                        <div>
                            <input name="reward_eligibility" type="radio" class="span1" checked="true" ng-model="tmpo.offer.user_eligibility.criteria.condition" value="on every">&nbsp;On every
                        </div>
                        <div>
                            <input name="reward_eligibility" type="radio" class="span1" ng-model="tmpo.offer.user_eligibility.criteria.condition" value="after">&nbsp;After
                        </div>
                        <div>
                            <input name="reward_eligibility" type="radio" class="span1" ng-model="tmpo.offer.user_eligibility.criteria.condition" value="on only">&nbsp;On only
                        </div>
                    </div>
                    <div class="row-fluid span8">
                        <input id="eligibility_value" name="eligibility_value" placeholder="Eg: 10" class="span8" type="number" ng-model="tmpo.offer.user_eligibility.criteria.value"><span class="add-on"> visits</span>
                    </div>
                </div>
            </div>
            <div class="well">
                <div class="row-fluid">
                    <div class="row-fluid span4">
                        <label>Choose a Reward</label>
                    </div>
                    <div class="row-fluid span8">
                        <p></p>
                    </div>
                </div>
                <div class="row-fluid">
                    <div class="row-fluid span4">
                        <label ng-repeat="n in reward_check">
                            <input type="radio" ng-model="$parent.selected_reward" ng-value="n" />&nbsp;&nbsp;{{n.text}}
                        </label>
                    </div>
                    <div class="row-fluid span8">
                        <div id="percentageDiscount" ng-if="selected_reward.value === 'discount'" ng-init="tmpo.offer.reward = ''">
                            <div class="row-fluid span12" style="margin:0px">
                                <div class="row-fluid span4">Percentage discount</div>
                                <div class="row-fluid span8">
                                    <select id="title" name="title" class="span8" ng-model="tmpo.offer.reward.discount.percentage">
                                        <option>5%</option>
                                        <option>10%</option>
                                        <option>15%</option>
                                        <option>20%</option>
                                        <option>25%</option>
                                        <option>30%</option>
                                        <option>35%</option>
                                        <option>40%</option>
                                        <option>45%</option>
                                        <option>50%</option>
                                        <option>55%</option>
                                        <option>60%</option>
                                        <option>65%</option>
                                        <option>70%</option>
                                        <option>75%</option>
                                        <option>80%</option>
                                        <option>85%</option>
                                        <option>90%</option>
                                        <option>95%</option>
                                        <option>100%</option>
                                    </select>
                                </div>
                            </div>
                            <div class="row-fluid span12" style="margin:0px">
                                <div class="row-fluid span4">Maximum discount</div>
                                <div class="row-fluid span8">
                                    <input id="title" name="title" placeholder="Eg: 1500" class="span8" type="text" ng-model="tmpo.offer.reward.discount.max">
                                </div>
                            </div>
                        </div>
                        <div id="flatOff" ng-if="selected_reward.value === 'flat'" ng-init="tmpo.offer.reward = ''">
                            <div class="row-fluid span12" style="margin:0px">
                                <div class="row-fluid span5">Amount off</div>
                                <div class="row-fluid span7">
                                    <input id="title" name="title" placeholder="Eg: 200" class="span8" type="text" ng-model="tmpo.offer.reward.flat.off">
                                </div>
                            </div>
                            <div class="row-fluid span12" style="margin:0px">
                                <div class="row-fluid span5">On a minimum spend</div>
                                <div class="row-fluid span7">
                                    <input id="title" name="title" placeholder="Eg: 1500" class="span8" type="text" ng-model="tmpo.offer.reward.flat.spend">
                                </div>
                            </div>
                        </div>
                        <div id="free" ng-if="selected_reward.value === 'free'" ng-init="tmpo.offer.reward = ''">
                            <div class="row-fluid span12" style="margin:0px">
                                <div class="row-fluid span3">Get a free</div>
                                <div class="row-fluid span9">
                                    <input id="title" name="title" placeholder="e.g. Dessert" class="span8" type="text" ng-model="tmpo.offer.reward.free.title">
                                </div>
                            </div>
                            <div class="row-fluid span12" style="margin:0px">
                                <div class="row-fluid span3">With</div>
                                <div class="row-fluid span9">
                                    <input id="title" name="title" placeholder="e.g. Dessert" class="span8" type="text" ng-model="tmpo.offer.reward.free._with">
                                </div>
                            </div>
                        </div>
                        <div id="buy_one_get_one" ng-if="selected_reward.value === 'buy_one_get_one'" ng-init="tmpo.offer.reward = ''">
                            <div class="row-fluid span12" style="margin:0px">
                                <div class="row-fluid span3">Buy one Get one</div>
                                <div class="row-fluid span9">
                                    <input id="title" name="title" placeholder="e.g. Dessert" class="span8" type="text" ng-model="tmpo.offer.reward.buy_one_get_one.title">
                                </div>
                            </div>
                        </div>
                        <div id="happyHours" ng-if="selected_reward.value === 'happy'" ng-init="tmpo.offer.reward = ''">
                            <div class="row-fluid span12" style="margin:0px">
                                <div class="row-fluid span5">Extension happy hours by</div>
                                <div class="row-fluid span7">
                                    <select id="title" name="title" class="span7" ng-model="tmpo.offer.reward.happyhours.extension">
                                        <option value="30 minutes">30 minutes</option>
                                        <option value="60 minutes">60 minuutes</option>
                                        <option value="90 minutes">90 minutes</option>
                                        <option value="2 hours">2 hours</option>
                                        <option value="3 hours">3 hours</option>
                                        <option value="All day">All day</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div id="reducedPrice" ng-if="selected_reward.value === 'reduced'" ng-init="tmpo.offer.reward = ''">
                            <div class="row-fluid span12" style="margin:0px">
                                <div class="row-fluid span2">Get</div>
                                <div class="row-fluid span10">
                                    <input id="title" name="title" placeholder="Eg: buffet lunch" class="span8" type="text" ng-model="tmpo.offer.reward.reduced.what">
                                </div>
                            </div>
                            <div class="row-fluid span12" style="margin:0px">
                                <div class="row-fluid span2">Worth Rs</div>
                                <div class="row-fluid span3">
                                    <input id="title" name="title" placeholder="Eg: 1500" class="span8" type="text" ng-model="tmpo.offer.reward.reduced.worth">
                                </div>
                                <div class="row-fluid span2" style="margin:0px">For Rs</div>
                                <div class="row-fluid span3" style="margin-left:4px">
                                    <input id="title" name="title" placeholder="Eg: 250." class="span8" type="text" ng-model="tmpo.offer.reward.reduced.for_what">
                                </div>
                            </div>
                        </div>
                        <div id="reducedPrice" ng-if="selected_reward.value === 'custom'" ng-init="tmpo.offer.reward = ''">
                            <div class="row-fluid span12" style="margin:0px">
                                <div class="row-fluid span4">Customized reward</div>
                                <div class="row-fluid span8">
                                    <textarea id="title" name="title" placeholder="Eg: Mothers get 50% off on mothers day" class="span12" type="text" ng-model="tmpo.offer.reward.custom.text">
                                    </textarea>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="well">
                <div class="row-fluid">
                    <div class="row-fluid span4">
                        <label>Reward applicability</label>
                    </div>
                    <div class="row-fluid span8">
                        <p></p>
                    </div>
                </div>
                <div id="applicability" class="row-fluid">
                    <div class="row-fluid span12">
                        Reward valid on
                    </div>
                    <div class="row-fluid span12">
                        <div class="row-fluid span4" style="margin:0px" ng-repeat="fruit in time_of_day">
                            <input id="checkbox" type='checkbox' ng-checked="rewardCheckedTime.indexOf(fruit) != -1" ng-click="rewardToggleCheckTime(fruit)">{{fruit}}
                            <br>
                        </div>
                    </div>
                    <div class="row-fluid span12" style="margin:0px">
                        Reward can be used on
                    </div>
                    <div class="row-fluid span12">
                        <div class="row-fluid span4" style="margin:0px" ng-repeat="fruit in day_of_week">
                            <input id="checkbox" type='checkbox' ng-checked="rewardCheckedDays.indexOf(fruit) != -1" ng-click="rewardToggleCheckDay(fruit)">{{fruit}}
                            <br>
                        </div>
                    </div>
                </div>
            </div>
            <div class="well">
                <div class="row-fluid">
                    <small>Timings</small>
                </div>
                <div class="row-fluid">
                    <div class="row-fluid span4">
                        <h4>Select outlet to replicate</h4>
                    </div>
                    <div class="span8">
                        <select ng-options="o.basics.name +', '+ o.contact.location.locality_1.toString() for o in all_outlets" ng-model="outlet_for._timings" class="span6">
                            <option value="NONE">NONE</option>
                        </select>
                    </div>
                </div>
                <div ng-repeat="w in week" class="row-fluid">
                    <div class="row-fluid pushTop10px">
                        <div class="row-fluid">
                            <div class="row-fluid span2">
                                <small>{{w}}</small>
                            </div>
                            <div class="row-fluid span2">
                                <small><input type="checkbox" ng-model="avail_hours[w].closed"> Closed</small>
                            </div>
                        </div>
                        <div class="row-fluid">
                            <div class="row-fluid span10 offset2" ng-repeat="t in avail_hours[w].timings track by $index">
                                <div class="span10" name="time">
                                    <div class="span2">
                                        <small>Open </small>
                                    </div>
                                    <div class="span2">
                                        <select ng-change="timingsValidation()" name="openhr" class="span12" ng-model="t.open.hr" ng-disabled="avail_hours[w].closed" required>
                                            <option ng-repeat="a in getRange(0, 23, 1)" ng-value="{{a}}">{{a}}</option>
                                        </select>
                                    </div>

                                    <div class="span2">
                                        <select ng-change="timingsValidation()";name="open.min" class="span12" ng-model="t.open.min" ng-disabled="avail_hours[w].closed" required>
                                            <option ng-repeat="a in getRange(0, 56, 5)" ng-value="{{a}}">{{a}}</option>
                                        </select>
                                    </div>
                                    <div class="span2" style="text-align:center; margin-top:4px;">
                                        <small>Close</small>
                                    </div>
                                    <div class="span2">
                                        <select ng-change="timingsValidation()" name="close.hr" class="span12" ng-model="t.close.hr" ng-disabled="avail_hours[w].closed" required>
                                            <option ng-repeat="a in getRange(0, 23, 1)" ng-value="{{a}}">{{a}}</option>
                                        </select>
                                    </div>

                                    <div class="span2">
                                        <select ng-change="timingsValidation()" name="close.min" class="span12" ng-model="t.close.min" ng-disabled="avail_hours[w].closed" required>
                                            <option ng-repeat="a in getRange(0, 56, 5)" ng-value="{{a}}">{{a}}</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="span2">
                                    <i class="fa fa-trash icon-red" ng-click="removeTimings(w, $index);timingsValidation()" ng-show="avail_hours[w].timings.length > 1"></i>
                                </div>
                                <div class="row-fluid span10" ng-show="(avail_hours[w].timings[$index].open.hr * 60 + avail_hours[w].timings[$index].open.min * 1) >= (avail_hours[w].timings[$index].close.hr * 60 + avail_hours[w].timings[$index].close.min * 1)">
                                    <small style="color: red">*open time can not be greater than or equal to close time.</small>
                                </div>
                            </div>

                        <div class="row-fluid span10" ng-show="!validationArray[$index]">
                            <small style="color: red">*Multiple Timings cannot overlap for same day.</small>
                        </div>
                        </div>
                        <div class="row-fluid">
                            <div class="row-fluid pushTop10px">
                                <div class="row-fluid span4">
                                    <small></small>
                                </div>

                                <div class="row-fluid span8">
                                    <div class="span6">
                                        <button class="btn btn-success btn-small" ng-click="newTimings($event, $index)" ng-disabled="avail_hours[w].closed">Add More Timings</button>
                                    </div>
                                    <div class="span6" ng-show="!$index">
                                        <button class="btn btn-success btn-small" ng-click="applyToAllDays(avail_hours[w]);timingsValidation()"> Apply to all days</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="well">
                <div class="row-fluid">
                    <div class="row-fluid span4">
                        <label>Terms & Conditions</label>
                    </div>
                    <div class="row-fluid span8">
                        <textarea id="title" name="title" placeholder="Eg: (maximum of 1000 Rs.)" class="span8" type="text" ng-model="tmpo.offer.terms"></textarea>
                    </div>
                </div>
            </div>
            <div class="well">
                <div class="row-fluid span4">
                    <small>Tags</small>
                </div>
                <div class="row-fluid span8">
                    <input class="span8" typeahead="tag for tag in getTags($viewValue)" ng-model="tag_list.tags" ng-list placeholder="Fun, Bright" type="text" ng-enter="fixupTags()">
                    <div>
                        <span ng-repeat="t in tmpo.offer.tags"><button class="btn btn-small btn-warning" ng-click="tmpo.offer.tags.splice($index,1)">{{t}}<i class=" icon-remove icon-white"></i></button>&nbsp;</span>
                    </div>
                </div>
            </div>
            <div class="well">
                <div class="row-fluid">
                  <div class="row-fluid span4">
                    <label>Voucher Valid For</label>
                  </div>
                  <input id="title" placeholder=" e.g. n " type="text" ng-model="tmpo.offer.voucher_valid_for_days" ng-click="show_tip_4 = true" tooltip="Number of days voucher should valid after voucher earned"  tooltip-trigger="focus" tooltip-placement="right">  Days       
                </div>
            </div>
        </div>
        <div class="span5 preview-detail" ng-include="'/merchant/templates/offer/preview.html'"></div>
    </div>
    <div class="row well">
        <button class='btn btn-inverse' ng-click="tabs[1].active=true;clearTier();">
            < Back</button>
                <button class="btn btn-inverse" ng-disabled="!program.name || offer_basics.program.name.$dirty && offer_basics.program.name.$invalid" ng-click="addOffer();fixupTags();tabs[3].active=true">Next ></button>
                <button class="btn btn-inverse" ng-disabled="!program.name || offer_basics.program.name.$dirty && offer_basics.program.name.$invalid" ng-click="addOffer();fixupTags();scrollToTop();">Add another offer to this tier</button>
                <button class="btn btn-inverse" ng-disabled="!program.name || offer_basics.program.name.$dirty && offer_basics.program.name.$invalid" ng-click="addOffer();tabs[1].active=true;">Start a new tier</button>
                <button ng-click="clear()" class="btn btn-warning">Clear</button>
    </div>
</form>