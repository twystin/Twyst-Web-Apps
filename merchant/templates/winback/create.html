<div class="row-fluid" style="min-height:580px;" ng-init="outletQuery()">	
	<div class="lead row-fluid offset1 span10" style="padding-top:30px;">
		<h2>Create a winback program</h2>
	</div>
	<div class="row-fluid">
		<div class="row-fluid offset1 span10">
			<div class="row-fluid">
				<div class="span2">
					Program Name
				</div>
				<div class="span10">
					<input required type="text" ng-model="winback.name" class="span4"> 
				</div>
			</div>
      		<div class="row-fluid">
				<div>
					Select Outlets
				</div>
				<div class="span10 offset2" ng-repeat="fruit in all_outlets">
					<span>
						<input id="checkbox" type='checkbox' ng-checked="winback.outlets.indexOf(fruit._id) != -1" ng-click="toggleOutlets(fruit._id)"> {{fruit.basics.name}}, {{fruit.contact.location.locality_1.toString()}}
					</span> 
				</div>
			</div>
			<div class="row-fluid">
	                <div class="row-fluid span2">
	                    <label>Description</label>
	                </div>
	                <div class="row-fluid span10">
	                    <textarea id="title" name="title" placeholder="Eg: ..." class="span4" type="text" ng-model="winback.description"></textarea>
	                </div>
	            </div>
			<div class="row-fluid">
				<div class="span2">
					Lifetime Check-ins
				</div>
				<div class="span10">
					<input required type="text" ng-model="winback.min_historical_checkins" class="span1"> 
				</div>
			</div>
			<div class="row-fluid">
				<div class="span2">
					Weeks since last visit
				</div>
				<div class="span10">
					<input required type="text" ng-model="winback.weeks_since_last_visit" class="span1"> 
				</div>
			</div>
			<div class="row-fluid">
				<div class="span2">
					Program Validity
				</div>
				<div class="span10">
					<div class="row-fluid">
		              <div class="row-fluid span4">
		                <div ng-controller="DatePickerCtrl">
		                    <div class="form-horizontal">
		                        <p>
		                            <input id="appendedInput" type="text" datepicker-popup="{{format}}" is-open="opened" min="minDate" max="'2015-06-22'" datepicker-options="dateOptions" date-disabled="disabled(date, mode)" ng-required="true" close-text="Close" placeholder="Start date" type="date" style="margin:0px;" ng-model="winback.validity.earn_start" class="span6" />
		                            <button class="btn" ng-click="open()"><i class="icon-calendar"></i></button>
		                        </p>
		                    </div>
		                </div>
		              </div>
		              <div class="row-fluid span4" style="margin:0px">
		                <div ng-controller="DatePickerCtrl">
		                    <div class="form-horizontal">
		                        <p>
		                            <input id="appendedInput" type="text" datepicker-popup="{{format}}" is-open="opened" min="minDate" max="'2015-06-22'" datepicker-options="dateOptions" date-disabled="disabled(date, mode)" ng-required="true" close-text="Close" placeholder="End date" type="date" style="margin:0px" ng-model="winback.validity.earn_end" class="span6" />
		                            <button class="btn" ng-click="open()"><i class="icon-calendar"></i></button>
		                        </p>
		                    </div>
		                </div>
		              </div>
	        		</div>
				</div>
			</div>
			<div class="row-fluid">
				<div class="span2">
					Voucher Validity (days)
				</div>
				<div class="span10">
					<input required type="text" ng-model="winback.validity.voucher_valid_days" class="span1"> 
				</div>
			</div>
			<div class="row-fluid">
				<div class="row-fluid">
	                <div class="row-fluid span2">
	                    Reward
	                </div>
	                <div class="row-fluid span10">
	                	<textarea required ng-model="winback.reward"></textarea>
	                </div>
	            </div>
	            <div class="row-fluid">
	                <div class="row-fluid span2">
	                    <label>Terms & Conditions</label>
	                </div>
	                <div class="row-fluid span10">
	                    <textarea id="title" name="title" placeholder="Eg: (maximum of 1000 Rs.)" class="span4" type="text" ng-model="winback.terms"></textarea>
	                </div>
	            </div>
	            <div>
	                <div class="row-fluid">
	                    Timings
	                </div>
	                <div class="row-fluid">
	                    <div class="span2">
	                        <h4>Select outlet to replicate</h4>
	                    </div>
	                    <div class="span6">
	                        <select ng-options="o.basics.name +', '+ o.contact.location.locality_1.toString() for o in all_outlets" ng-model="outlet_for._timings" class="span6">
	                            <option value="NONE">NONE</option>
	                        </select>
	                    </div>
	                </div>
	                <div ng-repeat="w in week" class="row-fluid">
	                    <div class="row-fluid pushTop10px">
	                        <div class="row-fluid">
	                            <div class="row-fluid span2">
	                                <small>{{w}}</small>
	                            </div>
	                            <div class="row-fluid span2">
	                                <small><input type="checkbox" ng-model="avail_hours[w].closed"> Closed</small>
	                            </div>
	                        </div>
	                        <div class="row-fluid">
	                            <div class="row-fluid span8 offset2" ng-repeat="t in avail_hours[w].timings track by $index">
	                                <div class="span10" name="time">
	                                    <div class="span2">
	                                        <small>Open </small>
	                                    </div>
	                                    <div class="span2">
	                                        <select ng-change="timingsValidation()" name="openhr" class="span12" ng-model="t.open.hr" ng-disabled="avail_hours[w].closed" required>
	                                            <option ng-repeat="a in getRange(0, 23, 1)" ng-value="{{a}}">{{a}}</option>
	                                        </select>
	                                    </div>

	                                    <div class="span2">
	                                        <select ng-change="timingsValidation()";name="open.min" class="span12" ng-model="t.open.min" ng-disabled="avail_hours[w].closed" required>
	                                            <option ng-repeat="a in getRange(0, 59, 1)" ng-value="{{a}}">{{a}}</option>
	                                        </select>
	                                    </div>
	                                    <div class="span2" style="text-align:center; margin-top:4px;">
	                                        <small>Close</small>
	                                    </div>
	                                    <div class="span2">
	                                        <select ng-change="timingsValidation()" name="close.hr" class="span12" ng-model="t.close.hr" ng-disabled="avail_hours[w].closed" required>
	                                            <option ng-repeat="a in getRange(0, 23, 1)" ng-value="{{a}}">{{a}}</option>
	                                        </select>
	                                    </div>

	                                    <div class="span2">
	                                        <select ng-change="timingsValidation()" name="close.min" class="span12" ng-model="t.close.min" ng-disabled="avail_hours[w].closed" required>
	                                            <option ng-repeat="a in getRange(0, 59, 1)" ng-value="{{a}}">{{a}}</option>
	                                        </select>
	                                    </div>
	                                </div>
	                                <div class="span2">
	                                    <i class="fa fa-trash icon-red" ng-click="removeTimings(w, $index);timingsValidation()" ng-show="avail_hours[w].timings.length > 1"></i>
	                                </div>
	                                <div class="row-fluid span10" ng-show="(avail_hours[w].timings[$index].open.hr * 60 + avail_hours[w].timings[$index].open.min * 1) >= (avail_hours[w].timings[$index].close.hr * 60 + avail_hours[w].timings[$index].close.min * 1)">
	                                    <small style="color: red">*open time can not be greater than or equal to close time.</small>
	                                </div>
	                            </div>

	                        <div class="row-fluid span10" ng-show="!validationArray[$index]">
	                            <small style="color: red">*Multiple Timings cannot overlap for same day.</small>
	                        </div>
	                        </div>
	                        <div class="row-fluid">
	                            <div class="row-fluid pushTop10px">
	                                <div class="span2">
	                                    <small></small>
	                                </div>

	                                <div class="span8">
	                                    <div class="span4">
	                                        <button class="btn btn-success btn-small" ng-click="newTimings($event, $index)" ng-disabled="avail_hours[w].closed">Add More Timings</button>
	                                    </div>
	                                    <div class="span4" ng-show="!$index">
	                                        <button class="btn btn-success btn-small" ng-click="applyToAllDays(avail_hours[w]);timingsValidation()"> Apply to all days</button>
	                                    </div>
	                                </div>
	                            </div>
	                        </div>
	                    </div>
	                </div>
	            </div>
			</div>
		</div>
	</div>
	<div class="row-fluid offset1 span10">
		<button ng-click="create()" class="btn btn-success">Create</button>
	</div>
</div>
